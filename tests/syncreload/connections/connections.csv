action,ms,bytes,lang,code,repeat,minver,comment
beforeany,0,0,q,system "sleep 5",1,,"wait for all procs to go up"
before,0,0,q,hdbHandle:gethandle[`hdb1],1,,"Get handle to the HDB"
before,0,0,q,rdb1Handle:gethandle[`rdb1],1,,"Get handle to RDB1"
before,0,0,q,rdb2Handle:gethandle[`rdb2],1,,"Get handle to RDB2"
before,0,0,q,wdbHandle:gethandle[`wdb1],1,,"Get handle to WDB"
before,0,0,q,gwHandle:gethandle[`gateway1],1,,"Get handle to gateway"
before,0,0,q,gwconnections:gwHandle(`.gw.reloadcalls;`),1,,"get list of connections to the gateway"
true,0,0,q,2~count hdbHandle(`.hdb.reloadcalls;`),1,,"check number of connections to the HDB"
true,0,0,q,1~count rdb1Handle(`.rdb.reloadcalls;`),1,,"check number of connections to RDB1"
true,0,0,q,1~count rdb2Handle(`.rdb.reloadcalls;`),1,,"check number of connections to RDB12"
true,0,0,q,2~count gwHandle(`.gw.reloadcalls;`),1,,"check number of connections to the gateway"
run,0,0,q,system "kill -15 rdb1",1,,"shut down rdb1 process"
run,0,0,q,system "sleep 5",1,,"to ensure rdb1 shuts down"
true,0,0,q,2~count hdbHandle(`.hdb.reloadcalls;`),1,,"check number of connections to the HDB"
true,0,0,q,1~count rdb2Handle(`.rdb.reloadcalls;`),1,,"check number of connections to RDB2"
true,0,0,q,2~count gwHandle(`.gw.reloadcalls;`),1,,"check number of connections to the gateway"
run,0,0,q,system "kill -15 rdb2",1,,"shut down rdb2 process"
run,0,0,q,system "sleep 5",1,,"to ensure rdb2 shuts down"
true,0,0,q,2~count hdbHandle(`.hdb.reloadcalls;`),1,,"check number of connections to the HDB"
true,0,0,q,2~count gwHandle(`.gw.reloadcalls;`),1,,"check number of connections to the gateway"

action,ms,bytes,lang,code,repeate,minver,comment
before,0,0,q,.Q.en[temphdbdir;testtrade],1,,"Enumerating test trade table"
before,0,0,q,symcount:exec distinct sym from testtrade,1,,"getting number of distinct syms"
true,0,0,q,all (exec distinct sym from testtrade) in sym,1,,"Check symbols have been enumerated"
fail,0,0,q,.ds.upserttopartition[temphdbdir;`testtrade;`price;testtrade;.z.p],1,,"Check upsert fails on non-sym columns"
fail,0,0,q,.ds.upserttopartition[temphdbdir;`testtrade;`pric;testtrade;.z.p],1,,"Check upsert fails on non-existant tables"
run,0,0,q,.ds.savetablesoverperiod[temphdbdir;`testtrade;.z.p],1,,"Running savedown function on testtrade table"
true,0,0,q,4=count (system"ls "\,1_string[temphdbdir]) except enlist "sym,1,,"Check number of symbols corresponds to number of partitions"
true,0,0,q,0=count testtrade,1,,"Check contents of test trade table has been deleted"
after,0,0,q,.os.deldir temphdbdir,1,,"Delete temp HDB"

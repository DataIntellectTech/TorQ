action,ms,bytes,lang,code,repeate,minver,comment
before,0,0,q,tr:.servers.gethandlebytype[`tr_seg1;`any],1,,"Open tailreader port"
before,0,0,q,tl:.servers.gethandlebytype[`tailer_seg1;`any],1,,"Open tailer"
run,0,0,q,system "sleep 10",1,,"Wait 10 seconds to populate tables"
before,0,0,q,tl".wdb.rowthresh:100",1,,"Set row count"
run,0,0,q,tl"![;();0b;`symbol$()]`trade",1,,"Clear trade table"
run,0,0,q,tl".ds.savealltablesoverperiod[]",1,,"Running savedown function on tables"
true,0,0,q,(tl"count quote")=0,1,,"Check quote table data is cleared"
true,0,0,q,(tr"count tables[]")=4,1,,"Tables added and no trade table"
true,0,0,q,(tr"count quote")>100,1,,"Check quote is above 100"
run,0,0,q,system "sleep 10",1,,"Wait for 10 secs"
run,0,0,q,tl".ds.savealltablesoverperiod[]",1,,"Running savedown function on tables"
true,0,0,q,(tl"count quote")=0,1,,"Check quote is empty"
true,0,0,q,(tl"count trade")=0,1,,"Check trade is empty"
true,0,0,q,(tr"count quote")>200,1,,"Check quote value is above 200 indicating it saved again"
true,0,0,q,(tr"count trade")>100,1,,"Check trade is saved"
true,0,0,q,(tr"count tables[]")=5,1,,"Tables added and trade table"

action,ms,bytes,lang,code,repeat,minver,comment
before,0,0,q,.rdb.subtables:(),1,,"Clear subscription tables"
before,0,0,q,.rdb.subfiltered:0b,1,,"Turn off subscription filters"
before,0,0,q,.rdb.subscribeto:`,1,,"Turn off subscription filters"
before,0,0,q,.rdb.subscribesyms:`,1,,"Turn off subscription filters"
before,0,0,q,.rdb.subscribe[],1,,"Subscribe to all data from stp"
before,0,0,q,.tst.t:count trade,1,,"Save table count"
before,0,0,q,.tst.q:count quote,1,,"Save table count"
before,0,0,q,.tst.h:first .sub.getsubscriptionhandles[.rdb.tickerplanttypes;();()!()]`w,1,,"Save handle to stp"
before,0,0,q,updf:{[x;t;h]$[x[1]~t;x[0] . (x[1];x[2]);updf[h[];t;h]]},1,,"Function to allow updates"
true,0,0,q,.ds.datastripe=1b,1,,"Check datastriping is set to 1"
true,0,0,q,0N=first .ds.segmentid,1,,"check value of segid set to null"
after,0,0,q,".tst.h"".stpps.closesub .z.w""",1,,"Close subscription"
after,0,0,q,trade:0#trade,1,,"Clear tables"
after,0,0,q,quote:0#quote,1,,"Clear tables"

action,ms,bytes,lang,code,repeat,minver,comment
before,0,0,q,.servers.startup[],1,,"Set up connections"
before,0,0,q,stpHandle:gethandle[`stp1],1,,"Open handle to STP"
before,0,0,q,stpHandle(`.stplg.init;tstlogs),1,,"Re-init logs"
true,0,0,q,-11 98h~type each first stpHandle(`.ps.subtable;"";""),1,,"Subscribe for all tables and syms"
true,0,0,q,all 0<raze value stpHandle(`.stpps.subrequestall),1,,"Check subrequestall populated"
run,0,0,q,hclose stpHandle,1,,"Disconnect"
run,0,0,q,stpHandle:gethandle[`stp1],1,,"Open handle to STP"
true,0,0,q,-11 98h~type each stpHandle(`.ps.subtable;"trade";simplesyms),1,,"Subscribe for one table and subset of syms"
true,0,0,q,1~count stpHandle(`.stpps.subrequestfiltered),1,,"Check subrequestfiltered populated"
run,0,0,q,hclose stpHandle,1,,"Disconnect"
run,0,0,q,stpHandle:gethandle[`stp1],1,,"Open handle to STP"
true,0,0,q,-11 98h~type each stpHandle(`.ps.subtablefiltered;"trade";complexwhr;""),1,,"Subscribe for one table and a where clause"
true,0,0,q,1~count stpHandle(`.stpps.subrequestfiltered),1,,"Check subrequestfiltered populated"
run,0,0,q,hclose stpHandle,1,,"Disconnect"
run,0,0,q,stpHandle:gethandle[`stp1],1,,"Open handle to STP"
true,0,0,q,-11 98h~type each stpHandle(`.ps.subtablefiltered;"trade";complexwhr;columnlist),1,,"Subscribe for one table and a where clause and col list"
true,0,0,q,1~count stpHandle(`.stpps.subrequestfiltered),1,,"Check subrequestfiltered populated"
run,0,0,q,hclose stpHandle,1,,"Disconnect"
run,0,0,q,stpHandle:gethandle[`stp1],1,,"Open handle to STP"
fail,0,0,q,stpHandle(`.ps.subtablefiltered;"trade";badwhr;""),1,,"Subscribe for one table and a bad where clause"
true,0,0,q,0~count stpHandle(`.stpps.subrequestfiltered),1,,"Check subrequestfiltered not populated"
run,0,0,q,hclose stpHandle,1,,"Disconnect"
run,0,0,q,stpHandle:gethandle[`stp1],1,,"Open handle to STP"
run,0,0,q,stpHandle(`.u.sub;`;`),1,,"Subscribe for everything with .u.sub"
true,0,0,q,all 0<raze value stpHandle(`.stpps.subrequestall),1,,"Check subrequestall populated"
run,0,0,q,hclose stpHandle,1,,"Disconnect"
run,0,0,q,stpHandle:gethandle[`stp1],1,,"Open handle to STP"
run,0,0,q,stpHandle(`.u.sub;`trade;`GOOG`AMZN),1,,"Subscribe for one table and subset of syms with .u.sub"
true,0,0,q,1~count stpHandle(`.stpps.subrequestfiltered),1,,"Check subrequestall populated"
after,0,0,q,.os.deldir tstlogsdir,1,,"Delete test log directory"
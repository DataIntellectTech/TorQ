action,ms,bytes,lang,code,repeat,minver,comment
before,0,0,q,rdbHandles:rdbNames!gethandle each rdbNames:exec procname from (.proc`readprocs).proc`file where proctype=`rdb,1,,"Open handle to RDBs"
before,0,0,q,value[rdbHandles] @\: "quote:0#quote; trade:0#trade",1,,"Clear RDBs tables"
true,0,0,q,numseg~sum `rdb=.servers.SERVERS`proctype,1,,"Check the number of running rdbs is the same as that of process.csv"
before,0,0,q,rep:1000,1,,"Number of repetitions for loop test"
before,0,0,q,"genQupdNew:{x,enlist 1_'last[x],'q(1+1?til y)0};genTupdNew:{x,enlist 1_'last[x],'t(1+1?til y)0}",1,,"General functions to generate a list of table updates with a range of NEW symbol"
before,0,0,q,delete subreq from `.ds,1,,"Delete subscription request (dict map) for performance testing"
true,0,0,q,not`subreq in key`.ds,1,,"Check subscription request has been deleted"
run,0,0,q,row:1000; uniq:10; qupd:qu[row;uniq]; tupd:tu[row;uniq],1,,"Test 1k records with ~10 uniques"
run,1,0,q,.u.upd[`trade;tupd],1,,"Performance test for INITIALIZATION of subscription request (dict map)"
run,1,0,q,.u.upd[`quote;qupd],1,,"(PARTIAL) INITIALIZATION – Note that if there are overlapping syms in the table updates it will be faster"
run,140,0,q,.u.upd[`trade;tupd],1000,,"Performance test for striping function with NO NEW input symbols"
run,150,0,q,.u.upd[`quote;qupd],1000,,"Performance test for striping function with NO NEW input symbols"
run,0,0,q,"qupdNew:genQupdNew[;1]/[rep-1;enlist qupd];tupdNew:genTupdNew[;1]/[rep-1;enlist tupd]",1,,"Generate a list of table updates with 1 NEW symbol each update"
run,140,0,q,.u.upd[`trade]'[tupdNew],1,,"Performance test for striping function with 1 NEW symbol each update"
run,150,0,q,.u.upd[`quote]'[qupdNew],1,,"Performance test for striping function with 1 NEW symbol each update – Note that if there are overlapping syms in the table updates it will be faster"
run,0,0,q,delete subreq from `.ds,1,,"Delete subscription request (dict map) for performance testing"
true,0,0,q,not`subreq in key`.ds,1,,"Check subscription request has been deleted"
run,0,0,q,row:10000; uniq:100; qupd:qu[row;uniq]; tupd:tu[row;uniq],1,,"Test 10k records with ~100 uniques"
run,2,0,q,.u.upd[`trade;tupd],1,,"Performance test for INITIALIZATION of subscription request (dict map)"
run,2,0,q,.u.upd[`quote;qupd],1,,"(PARTIAL) INITIALIZATION – Note that if there are overlapping syms in the table updates it will be faster"
run,1100,0,q,.u.upd[`trade;tupd],1000,,"Performance test for striping function with NO NEW input symbols"
run,1300,0,q,.u.upd[`quote;qupd],1000,,"Performance test for striping function with NO NEW input symbols"
run,0,0,q,"qupdNew:genQupdNew[;3]/[rep-1;enlist qupd];tupdNew:genTupdNew[;3]/[rep-1;enlist tupd]",1,,"Generate a list of table updates with 1 to 3 NEW symbols each update"
run,1100,0,q,.u.upd[`trade]'[tupdNew],1,,"Performance test for striping function with 1 to 3 NEW symbols each update"
run,1300,0,q,.u.upd[`quote]'[qupdNew],1,,"Performance test for striping function with 1 to 3 NEW symbols each update"
run,0,0,q,delete subreq from `.ds,1,,"Delete subscription request (dict map) for performance testing"
true,0,0,q,not`subreq in key`.ds,1,,"Check subscription request has been deleted"
run,0,0,q,rep:100,1,,"Number of repetitions for loop test"
run,0,0,q,row:100000; uniq:1000; qupd:qu[row;uniq]; tupd:tu[row;uniq],1,,"Test 100k records with ~1k uniques"
run,14,0,q,.u.upd[`trade;tupd],1,,"Performance test for INITIALIZATION of subscription request (dict map)"
run,15,0,q,.u.upd[`quote;qupd],1,,"(PARTIAL) INITIALIZATION – Note that if there are overlapping syms in the table updates it will be faster"
run,1100,0,q,.u.upd[`trade;tupd],100,,"Performance test for striping function with NO NEW input symbols"
run,1300,0,q,.u.upd[`quote;qupd],100,,"Performance test for striping function with NO NEW input symbols"
run,0,0,q,"qupdNew:genQupdNew[;10]/[rep-1;enlist qupd];tupdNew:genTupdNew[;10]/[rep-1;enlist tupd]",1,,"Generate a list of table updates with 1 to 10 NEW symbols each update"
run,1300,0,q,.u.upd[`trade]'[tupdNew],1,,"Performance test for striping function with 1 to 10 NEW symbols each update"
run,1500,0,q,.u.upd[`quote]'[qupdNew],1,,"Performance test for striping function with 1 to 10 NEW symbols each update"
after,0,0,q,value[rdbHandles] @\: "quote:0#quote";value[rdbHandles] @\: "trade:0#trade",1,,"Clear RDBs tables"
after,0,0,q,"system ""rm -rf "",1_string .stplg.dldir",1,,"Delete logs folder"
after,0,0,q,"startorstopproc[""stop"";""all"";getenv[`testpath],""/process.csv""]",1,,"Stop all proccess"
action,ms,bytes,lang,code,repeat,minver,comment
before,0,0,q,system "sleep 2",1,,"Wait a sec"
before,0,0,q,.servers.startup[],1,,"Set up TorQ connection management"
before,0,0,q,localise each (nonelogs;perilogs;tabulogs),1,,"Set all meta table paths to local system"
before,0,0,q,trephandle:gethandle[`trep1],1,,"Open handle to tickerlog replay process"
before,0,0,q,trephandle(set;`.replay.segmentedmode;0b),1,,"Turn off segmented mode"
before,0,0,q,trephandle(`.replay.initandrun;::),1,,"Replay old TP logs"
before,0,0,q,system loadhdb,1,,"Load in test HDB"
true,0,0,q,400 1965 8 9~count each (trade;quote;cols trade;cols quote),1,,"Get table row and column counts"
run,0,0,q,"delete trade,quote from `.",1,,"Scrub local tables"
true,0,0,q,all not `trade`quote in tables[],1,,"Make sure trade and quote table are gone"
run,0,0,q,trephandle(resplay;nonelogs),1,,"Reset replay process and replay next set of logs"
run,0,0,q,system loadhdb,1,,"Load in test HDB"
true,0,0,q,10 10 9 10~count each (trade;quote;cols trade;cols quote),1,,"Get table row and column counts"
run,0,0,q,"delete trade,quote from `.",1,,"Scrub local tables"
true,0,0,q,all not `trade`quote in tables[],1,,"Make sure trade and quote table are gone"
run,0,0,q,trephandle(resplay;perilogs),1,,"Reset replay process and replay next set of logs"
run,0,0,q,system loadhdb,1,,"Load in test HDB"
true,0,0,q,20 20 9 10~count each (trade;quote;cols trade;cols quote),1,,"Get table row and column counts"
run,0,0,q,"delete trade,quote from `.",1,,"Scrub local tables"
true,0,0,q,all not `trade`quote in tables[],1,,"Make sure trade and quote table are gone"
run,0,0,q,trephandle(resplay;tabulogs),1,,"Reset replay process and replay next set of logs"
run,0,0,q,system loadhdb,1,,"Load in test HDB"
true,0,0,q,20 20 9 10~count each (trade;quote;cols trade;cols quote),1,,"Get table row and column counts"
run,0,0,q,.os.deldir testhdb,1,,"Delete test HDB"
run,0,0,q,"delete trade,quote from `.",1,,"Scrub local tables"
true,0,0,q,all not `trade`quote in tables[],1,,"Make sure trade and quote table are gone"
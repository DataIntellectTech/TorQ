action,ms,bytes,lang,code,repeat,minver,comment
comment,0,,"Test 1 - Check all the schemas are empty after having written to the DB"
before,0,0,q,\c 200 200,1,,"Set width of .Q.s1 to be wide enough for all tables"
before,0,0,q,.servers.startup[],1,,"Start TorQ Connection Management"
before,0,0,q,.proc.sys "sleep 2",1,,"Wait for process to start"
before,0,0,q,hdbHandle:gethandle[`hdb1],1,,"Open HDB handle"
before,0,0,q,schemas:hdbHandle`.stpps.schemas,1,,"Open HDB handle"
true,0,0,q,([]time:`timestamp$();sym:`symbol$();procname:`symbol$();counter:`long$();pid:`int$();host:`symbol$();port:`int$())~schemas`heartbeat,,,"Check the schema is empty"
true,0,0,q,([]time:`timestamp$();sym:`symbol$();proctype:`symbol$();host:`symbol$();loglevel:`symbol$();id:`symbol$();message:())~schemas`logmsg,,,"Check the schema is empty"
true,0,0,q,""+`time`sym`src`dest`srcport`destport`seq`ack`win`tsval`tsecr`flags`protocol`length`len`data!`packets"~.Q.s1 schemas`packets,,,"Check the partitioned table schema is as expected"
true,0,0,q,""+`time`sym`bid`ask`bsize`asize`mode`ex`src!`quote"~.Q.s1 schemas`quote,,,"Check the partitioned table schema is as expected"
true,0,0,q,""+`time`sym`bid`ask`bsize`asize`mode`ex`srctime!`quote_iex"~.Q.s1 schemas`quote_iex,,,"Check the partitioned table schema is as expected"
true,0,0,q,""+`time`sym`price`size`stop`cond`ex`side!`trade"~.Q.s1 schemas`trade,,,"Check the partitioned table schema is as expected"
true,0,0,q,""+`time`sym`price`size`stop`cond`ex`srctime!`trade_iex"~.Q.s1 schemas`trade_iex,,,"Check the partitioned table schema is as expected"
after,0,0,q,hclose hdbHandle,1,,"Close handles"
after,0,0,q,.os.deldir hdbdir,1,,"Delete test hdb"

comment,0,,"Test 2 - Check all the schemas are empty for the attrstripped versions of tables"
before,0,0,q,\c 200 200,1,,"Set width of .Q.s1 to be wide enough for all tables"
before,0,0,q,.servers.startup[],1,,"Start TorQ Connection Management"
before,0,0,q,.proc.sys "sleep 2",1,,"Wait for process to start"
before,0,0,q,stpHandle:gethandle[`stp1],1,,"Open HDB handle"
before,0,0,q,schemasnoattributes:stpHandle`.stpps.schemasnoattributes,1,,"Open HDB handle"
true,0,0,q,([]time:`timestamp$();sym:`$();bid:`float$();ask:`float$();bsize:`long$();asize:`long$();mode:`char$();ex:`char$();src:`$())~schemasnoattributes`quote,,,"Check the schema is empty"
true,0,0,q,([]time:`timestamp$();sym:`symbol$();src:`symbol$();dest:`symbol$();srcport:`long$();destport:`long$();seq:`long$();ack:`long$();win:`long$();tsval:`long$();tsecr:`long$();flags:();protocol:`symbol$();length:`long$();len:`long$();data:())~schemasnoattributes`packets,,,"Check the partitioned table schema is as expected"
true,0,0,q,([]time:`timestamp$();sym:`$();bid:`float$();ask:`float$();bsize:`long$();asize:`long$();mode:`char$();ex:`char$();srctime:`timestamp$())~schemasnoattributes`quote_iex,,,"Check the partitioned table schema is as expected"
true,0,0,q,([]time:`timestamp$();sym:`$();price:`float$();size:`int$();stop:`boolean$();cond:`char$();ex:`char$();side:`$())~schemasnoattributes`trade,,,"Check the partitioned table schema is as expected"
true,0,0,q,([]time:`timestamp$();sym:`$();price:`float$();size:`int$();stop:`boolean$();cond:`char$();ex:`char$();srctime:`timestamp$())~schemasnoattributes`trade_iex,,,"Check the partitioned table schema is as expected"
after,0,0,q,hclose stpHandle,1,,"Close handles"
after,0,0,q,.os.deldir logdir,1,,"Delete test logs"